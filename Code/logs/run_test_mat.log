
[DEBUG] Found 224532 training files
[DEBUG] Unique train labels: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26], counts: {0: 8333, 1: 8318, 2: 8305, 3: 8369, 4: 8314, 5: 8351, 6: 8237, 7: 8287, 8: 8360, 9: 8312, 10: 8369, 11: 8254, 12: 8386, 13: 8290, 14: 8375, 15: 8263, 16: 8242, 17: 8374, 18: 8306, 19: 8297, 20: 8326, 21: 8413, 22: 8268, 23: 8283, 24: 8307, 25: 8309, 26: 8284}
[DEBUG] Synthetic data shape: torch.Size([2232, 6, 114, 10]), labels: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
SALD outer:   0%|          | 0/5 [00:00<?, ?it/s]SALD outer:   0%|          | 0/5 [00:06<?, ?it/s]
Traceback (most recent call last):
  File "/home/Lab208/Code/sald.py", line 78, in compute_subspace_from_features
    U, S, Vt = torch.linalg.svd(F, full_matrices=False)
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 19).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Lab208/Code/run_sald.py", line 8, in <module>
    synth_path = sald_distill()
  File "/home/Lab208/Code/sald.py", line 125, in sald_distill
    P_cpu, centroid_proj = compute_subspace_from_features(top_feats)
  File "/home/Lab208/Code/sald.py", line 81, in compute_subspace_from_features
    F_pinv = torch.linalg.pinv(F @ F.T)
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 19).
